<!DOCTYPE html>
<html>
  <head>
    <script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
    <script src="js/binaryheap.js?v=0"></script>
    <script src="js/simulation.js?v=0"></script>
    <script src="js/infinigraph.js?v=0"></script>
  </head>
<style>
    .data {
        position: absolute;
        top: 0px;
        left: 0px;
    }
</style>
  <body>
    <div id="data" style="display: inline-block;"></div>

<script type="text/javascript">
var board, sim, graph;

function init(){
    var width = window.innerHeight < window.innerWidth ?
        window.innerHeight : window.innerWidth;
    var height = width;

    document.getElementById('data')
        .setAttribute("style","width:"+width+"px; height:"+height+"px;");

    graph = new InfiniGraph("data");
}

var worker;
function launch(){
    reset();
    worker = new Worker("js/worker-sim.js?v=0");
    worker.postMessage({"cmd": "run", "alpha": 0.536, "mu": 1, "szr": true});
    worker.onmessage = function(e) {
        if (e.data['cmd'] == 'site')
            graph.update_sites(e.data['d']);
        if (e.data['cmd'] == 'report')
            console.log(e.data);
    }
}

function stop(){ worker.postMessage({"cmd": "stop"}); }
function reset(){ graph.reset_display(); }

init();
reset();

</script>
<br/>
<input type='button' value='go' style='top: 0; left: 0; position: absolute;' onclick='launch();'/>
<input type='button' value='stop' style='top: 0; left: 35px; position: absolute;' onclick='stop();'/>
  </body>
</html>
